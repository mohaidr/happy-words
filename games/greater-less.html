<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Analytics -->
    <script src="../js/analytics.js"></script>
    <script src="../js/i18n.js"></script>
    <title>Greater or Less üêä</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Baloo+Bhaijaan+2:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/games.css">
    <style>
        body {
            background: linear-gradient(135deg, #00b894, #00cec9);
        }
        
        .compare-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .number-box {
            width: 100px;
            height: 100px;
            background: linear-gradient(145deg, #fff, #f0f0f0);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            font-weight: bold;
            color: #2d3436;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .symbol-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .symbol-btn {
            width: 80px;
            height: 50px;
            font-size: 32px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .symbol-btn.greater {
            background: linear-gradient(145deg, #ff7675, #d63031);
            color: white;
        }
        
        .symbol-btn.equal {
            background: linear-gradient(145deg, #fdcb6e, #f39c12);
            color: white;
        }
        
        .symbol-btn.less {
            background: linear-gradient(145deg, #74b9ff, #0984e3);
            color: white;
        }
        
        .symbol-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .symbol-btn.correct {
            animation: pulse 0.5s ease;
            box-shadow: 0 0 20px rgba(0,255,0,0.5);
        }
        
        .symbol-btn.wrong {
            animation: shake 0.3s ease;
            opacity: 0.5;
        }
        
        .croc-tip {
            background: rgba(255,255,255,0.2);
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 18px;
            margin-top: 20px;
            max-width: 350px;
        }
        
        .croc-tip span {
            font-size: 24px;
        }
        
        #gameOver h2 { color: #00b894; }
        
        .feedback {
            font-size: 48px;
            height: 60px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <a href="../index.html" class="home-btn" data-i18n="game.home">‚Üê Home</a>
        <a href="category-math.html" class="category-btn" data-i18n="nav.math">üî¢ Math</a>
        <h1 data-i18n="greaterLess.title">üêä Greater or Less</h1>
    </div>
    
    <div class="stats">
        <div><span data-i18n="game.score">Score</span>: <span id="score">0</span></div>
        <div><span data-i18n="game.level">Level</span>: <span id="level">1</span></div>
        <div><span data-i18n="game.lives">Lives</span>: ‚ù§Ô∏è <span id="lives">3</span></div>
    </div>
    
    <div class="feedback" id="feedback"></div>
    
    <div class="compare-container">
        <div class="number-box" id="num1">5</div>
        
        <div class="symbol-buttons">
            <button class="symbol-btn greater" onclick="checkAnswer('>')" title="Greater than">&gt;</button>
            <button class="symbol-btn equal" onclick="checkAnswer('=')" title="Equal to">=</button>
            <button class="symbol-btn less" onclick="checkAnswer('<')" title="Less than">&lt;</button>
        </div>
        
        <div class="number-box" id="num2">3</div>
    </div>
    
    <div class="croc-tip">
        <span>üêä</span> <span data-i18n="greaterLess.tip">The hungry crocodile always eats the BIGGER number!</span>
    </div>
    
    <div id="gameOver">
        <h2 data-i18n="greaterLess.result">üéâ Great Job!</h2>
        <p id="playerDisplay"></p>
        <p><span data-i18n="game.finalScore">Final Score</span>: <span id="finalScore">0</span></p>
        <p>üèÜ <span data-i18n="game.highScore">High Score</span>: <span id="highScore">0</span></p>
        <button class="btn" onclick="startGame()" data-i18n="game.playAgain">Play Again</button>
        <a href="../index.html" class="home-link" data-i18n="game.backHome">‚Üê Back to Home</a>
    </div>
    
    <p class="info" data-i18n="greaterLess.instruction">Pick the symbol that goes between the numbers!</p>
    <p class="info" id="bestScoreDisplay">üèÜ <span data-i18n="game.best">Best</span>: --</p>

    <script src="../js/game-utils.js"></script>
    <script>
        const GAME_KEY = 'greaterLess';
        
        let score = 0;
        let level = 1;
        let lives = 3;
        let num1 = 0;
        
        let num2 = 0;
        let correctAnswer = '';
        let questionsAnswered = 0;
        let canAnswer = true;
        
        let highScore = GameUtils.getHighScore(GAME_KEY);
        let playerName = GameUtils.getPlayerName();
        let gradeLevel = GameUtils.getGradeLevel();
        
        function loadHighScore() {
            const saved = GameUtils.getHighScore(GAME_KEY);
            if (saved > 0) {
                const bestPlayer = GameUtils.getHighScorePlayerName(GAME_KEY);
                const highScoreText = typeof I18n !== 'undefined' 
                    ? I18n.t('game.highScorePoints', { score: saved, player: bestPlayer })
                    : `üèÜ Best: ${saved} points by ${bestPlayer}`;
                document.getElementById('bestScoreDisplay').innerHTML = highScoreText;
            } else {
                const defaultText = typeof I18n !== 'undefined' 
                    ? I18n.t('game.defaultHighScore')
                    : 'Best: -- points';
                document.getElementById('bestScoreDisplay').innerHTML = 'üèÜ ' + defaultText;
            }
        }
        
        function getNumberRange() {
            if (gradeLevel === 'kg') return 10;
            if (gradeLevel === 'g1-3') return 50 + (level * 10);
            return 100 + (level * 20);
        }
        
        function generateQuestion() {
            canAnswer = true;
            document.getElementById('feedback').textContent = '';
            
            const range = getNumberRange();
            num1 = Math.floor(Math.random() * range) + 1;
            num2 = Math.floor(Math.random() * range) + 1;
            
            // Sometimes make them equal (20% chance)
            if (Math.random() < 0.2) {
                num2 = num1;
            }
            
            document.getElementById('num1').textContent = num1;
            document.getElementById('num2').textContent = num2;
            
            if (num1 > num2) correctAnswer = '>';
            else if (num1 < num2) correctAnswer = '<';
            else correctAnswer = '=';
            
            // Reset button styles
            document.querySelectorAll('.symbol-btn').forEach(btn => {
                btn.classList.remove('correct', 'wrong');
                btn.disabled = false;
            });
        }
        
        function checkAnswer(answer) {
            if (!canAnswer) return;
            canAnswer = false;
            
            const buttons = document.querySelectorAll('.symbol-btn');
            buttons.forEach(btn => btn.disabled = true);
            
            const clickedBtn = document.querySelector(`.symbol-btn.${
                answer === '>' ? 'greater' : answer === '=' ? 'equal' : 'less'
            }`);
            
            if (answer === correctAnswer) {
                clickedBtn.classList.add('correct');
                score += 10 * level;
                questionsAnswered++;
                document.getElementById('feedback').textContent = '‚úÖ';
                GameUtils.playSound('correct');
                
                if (questionsAnswered % 5 === 0) {
                    level++;
                    document.getElementById('level').textContent = level;
                    GameUtils.playSound('levelUp');
                }
                
                document.getElementById('score').textContent = score;
            } else {
                clickedBtn.classList.add('wrong');
                // Show correct
                const correctBtn = document.querySelector(`.symbol-btn.${
                    correctAnswer === '>' ? 'greater' : correctAnswer === '=' ? 'equal' : 'less'
                }`);
                correctBtn.classList.add('correct');
                
                document.getElementById('feedback').textContent = '‚ùå';
                lives--;
                document.getElementById('lives').textContent = lives;
                GameUtils.playSound('wrong');
                
                if (lives <= 0) {
                    setTimeout(endGame, 1000);
                    return;
                }
            }
            
            setTimeout(generateQuestion, 1200);
        }
        
        function startGame() {
            score = 0;
            level = 1;
            questionsAnswered = 0;
            
            playerName = GameUtils.getPlayerName();
            gradeLevel = GameUtils.getGradeLevel();
            lives = GameUtils.getMaxLives({kg: 8, 'g1-3': 5, default: 3});
            gradeLevel = GameUtils.getGradeLevel();
            highScore = GameUtils.getHighScore(GAME_KEY);
            
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
            document.getElementById('lives').textContent = lives;
            document.getElementById('gameOver').style.display = 'none';
            
            generateQuestion();
        }
        
        function endGame() {
            const isNewHigh = GameUtils.saveHighScore(GAME_KEY, score, playerName);
            if (isNewHigh) highScore = score;
            
            const bestScore = Math.max(score, highScore);
            const bestPlayer = GameUtils.getHighScorePlayerName(GAME_KEY);
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('highScore').textContent = `${bestScore} by ${bestPlayer}`;
            document.getElementById('playerDisplay').textContent = playerName + "'s Game";
            document.getElementById('gameOver').style.display = 'block';
            loadHighScore();
        }
        
        // Initialize
        GameUtils.initSoundToggle();
        loadHighScore();
        setTimeout(() => startGame(), 500);
    </script>
    <script>
        // Add language toggle button
        if (typeof I18n !== 'undefined') {
            const langBtn = I18n.createLanguageToggle();
            document.body.appendChild(langBtn);
        }
    </script>
</body>
</html>
